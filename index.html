<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="./img/favicon.ico">
        <title>Yelmo-docs</title>
        <link href="./css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="./css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="./css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="./js/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap-3.0.3.min.js"></script>
        <script src="./js/highlight.pack.js"></script> 
    </head>

    <body class="homepage">

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href=".">Yelmo-docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href=".">Home</a>
                    </li>
                    <li >
                        <a href="getting-started/">Getting started</a>
                    </li>
                    <li >
                        <a href="parameters/">Parameters</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li class="disabled">
                        <a rel="next" >
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="getting-started/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#yelmo">Yelmo</a></li>
            <li><a href="#history">History</a></li>
            <li><a href="#directory-structure">Directory structure</a></li>
            <li><a href="#classes-and-usage">Classes and usage</a></li>
            <li><a href="#getting-the-code">Getting the code</a></li>
            <li><a href="#compiling-yelmo-programs">Compiling Yelmo programs</a></li>
            <li><a href="#running-the-programs">Running the programs</a></li>
            <li><a href="#parameter-modification">Parameter modification</a></li>
        <li class="main "><a href="#libraries">Libraries</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="yelmo">Yelmo</h1>
<p>Welcome to Yelmo, an easy to use continental ice sheet model.
<strong>Yelmo</strong> is a 3D thermomechanical ice sheet model that
simulates continental scale ice sheets. It is a so-called hybrid
model that solves both the Shallow Ice Approximation (SIA) for
land-based ice driven by deformation, and the Shallow Shelf
Approximation (SSA) for faster moving ice streams and ice shelves.</p>
<p>It has been designed to operate as a stand-alone model or to be easily plugged in as a module in another program. The key to its flexibility is that no variables are defined globally and parameters are defined according to the domain being modeled. In this way, all variables and calculations are store in an object that entirely represents the model domain.</p>
<h2 id="history">History</h2>
<p><strong>Yelmo</strong> is based on the GRISLI code developed by Catherine Ritz
(see Ritz et al., 1997), and subsequent modifications by coworkers in Grenoble and Paris until 2011.
The thermodynamic core (i.e., solvers) of <strong>Yelmo</strong> has not been modified
from GRISLI. Significant changes include all calculations related to
boundary conditions (surface mass balance, topography, basal melt,
sediments), as well as several helper modules to calculate the
thermodynamics (basal dragging, deformation parameters).</p>
<pre><code>! **********************************************************************
! GRISLI      Grenoble Ice Shelves-Land Ice
! **********************************************************************
! Ont participe a l'ecriture de ce modele :
!
!               Catherine Ritz                           (tout du long)
!                   &lt;catritz@lgge.obs.ujf-grenoble.fr&gt;
!               Adeline Fabre                      (la partie Gremlins)
!               Vincent Rommelaere         (ice shelves et ice streams)
!               Christophe Dumas (debut f90,              (Antarctique)
!               Vincent Peyaud      (portage HN,calving, front, hydrol)
!               Cyril Mazauric                                  (AGRIF)
!
! From 2011 onwards as Yelmo :
!               Alexander Robinson
!               Jorge Alvarez-Solas
!               Marisa Montoya
!               Ilaria Tabone
!               Javier Blasco
! **********************************************************************
</code></pre>

<h2 id="directory-structure">Directory structure</h2>
<pre><code>docs/
    Model documentation.
input/
    Location of any input data needed by the model.
    The REMBOv2_data respository should be available here as:
    `input/REMBOv2_data` which contains some useful boundary datasets.
libs/
    Auxiliary libraries nesecessary for running the model.
maps/
    Generated maps and grids.
output/
    Default location for model output.
src/
    Source code for Yelmo.
</code></pre>
<h2 id="classes-and-usage">Classes and usage</h2>
<h3 id="yelmo_class">yelmo_class</h3>
<p>The Yelmo class defines all data related to a model domain, such as Greenland or Antarctica. As seen below in the yelmo_class defintion, the 'class' is simply a user-defined Fortran type that contains additional types representing variousparameters, variables or sets of module variables.</p>
<pre><code>type yelmo_class

    type(param_class)     :: par      ! Parameters
    type(grid_class)      :: grid     ! Grid definition
    type(ytopo_class)     :: topo     ! topography variables
    type(yvel_class)      :: vel      ! velocity variables
    type(yen_class)       :: en       ! energy (temp, enthalpy) variables

end type
</code></pre>
<p>Likewise the module variables are defined in a similar way, e.g. ytopo_class that defines variables and parameters associated with the topography:</p>
<pre><code>type ytopo_class

    type(ytopo_param_class)   :: par        ! physical parameters
    type(boundary_opt_class)  :: bnd, bnd0  ! boundary switches (bnd0 for equilibration)

    ! All variables
    type(ytopo_state_class) :: now

end type
</code></pre>
<p>Submodules such as ytopo_class include parameter definitions relevant to topography calculations, as well as so-called 'boundary switches' that define whether a variable should be calculated using the module are considered as a boundary (i.e., forcing) variable. Finally the class contains an additional type that defines the state of the variables in the module.</p>
<h3 id="example-model-domain-intialization">Example model domain intialization</h3>
<p>The yelmo_class is defined along with a set of subroutines that can be used to initialize, access and change the object (in object-oriented language, class methods).</p>
<p>Assuming that a grid object has been defined previously (using the coordinates library), a yelmo_class object can be initialized using the following call:</p>
<pre><code>call yelmo_init(yelmo_grl,"Greenland",grid=grid_grl)
</code></pre>
<p>This will initialize the object <code>yelmo_grl</code> with the domain name "Greenland" and the model domain will match the grid defined by the grid object <code>grid_grl</code> (e.g., arrays will allocated to the size of the grid, etc.). Parameters will be initialized by first loading all of the default parameter sets from the Yelmo namelist file <code>src/yelmo.nml</code>. Next the program will look for a domain-specific namelist file that matches the name of the domain, in this case <code>Greenland.nml</code>. Any parameters that have been defined in this file will overwrite the default parameter values of the program.</p>
<p>There are only two additional public methods available for managing the yelmo_class object: <code>yelmo_update</code> and <code>yelmo_end</code>, which handle time-stepping of the model calculations and finalization (deallocation) of the object. <code>yelmo_end</code> is called at the end of the program or when a model domain variable should be deleted and the memory freed. <code>yelmo_update</code> is called in a time-stepping loop of a main program, e.g.:</p>
<pre><code>do year = 1, 100
    call yelmo_update(yelmo_grl,year=year)        
end do
</code></pre>
<p>That's it! All options that manage the calculations to be performed have been defined in <code>src/yelmo.nml</code> and <code>Greenland.nml</code>, therefore no additional information needs to be passed except the time step.</p>
<p>Exchange of information between the yelmo_class object and other models, modules or even external datasets stored in files can be performed by direct access, or more rigorously by defining a subroutine in the Yelmo exchange module (<code>src/yelmo_exchange.f90</code>).</p>
<h2 id="getting-the-code">Getting the code</h2>
<p>Yelmo is managed using the version control software <a href="http://www.git.org">git</a>. To get started with a local working copy of the code, you need to (1) clone the repository to a local path, (2) create your own branch so that your changes do not conflict with the master branch and (3) synchronize your branch with the central repository so that your changes are also under version control.</p>
<pre><code>git clone robinson@cluster.pik-potsdam.de:/iplex/01/tumble/robinson/repos/yelmo LOCAL_PATH
git checkout -b your_branch
git push -u origin your_branch
</code></pre>
<p>Note use the command <code>git branch</code> at any time to see which branches are available and which branch is currently checked out (marked by the asterisk).</p>
<p>That's it! You now have all of the Yelmo code in the local path <code>LOCAL_PATH</code>.</p>
<h3 id="bare-central-repository-locations">Bare (central) repository locations</h3>
<p>PIK repository location: <code>/iplex/01/tumble/robinson/repos/yelmo</code><br />
UCM repository location: <code>/home/fispalma25/repos/yelmo_mirror</code></p>
<h2 id="compiling-yelmo-programs">Compiling Yelmo programs</h2>
<p>Yelmo uses a Makefile to manage program compilation. Currently one test program exists for Yelmo development: <code>test_yelmo.x</code>. Compilation can be acheived via make:</p>
<pre><code>make test_yelmo    : compiles the program test_yelmo.x (ice sheet development program)
make clean         : removes all compiled files
</code></pre>
<p>By default, the Makefile will choose gfortran as the compiler and use the <code>-O3</code> compiler options. To compile on the PIK cluster using ifort add <code>ifort=1</code> to the end of the command, eg.:</p>
<pre><code>make test_yelmo ifort=1
</code></pre>
<p>Likewise to include debugging options, use <code>debug=1</code>:</p>
<pre><code>make test_yelmo debug=1
</code></pre>
<p>If compiled on the PIK cluster with ifort, the library paths given in the Makefile (mainly to find the netcdf libraries) should be correct and the programs should compile without any problems. For local compilation, typical Mac locations are currently specified that may need to be modified for other computers. To do so, find these lines in the Makefile:</p>
<pre><code>netcdf_inc = /opt/local/include
netcdf_lib = /opt/local/lib
</code></pre>
<h2 id="running-the-programs">Running the programs</h2>
<p>Yelmo is designed so that the source code is located in one place and each simulation produces output in a new directory. In this way, there is only one copy of the source code and compiled program, and one output directory for each program call.</p>
<p>By default, if no output directory is specified, the program sends output directly to the path <code>output</code> and can be run from the command line:</p>
<pre><code>./test_yelmo.x
</code></pre>
<p>Otherwise the output directory can be specified as a command-line argument. In this case, the output directory should already contain a copy of the namelist files for the domains to be simulated.</p>
<pre><code>mkdir output/simulation1
cp Greenland.nml output/simulation1/
./test_yelmo.x output/simulation1
</code></pre>
<p><em>Note: In the near future, the automatic generation of output directories, as well as batch simulations and parameter changes will be handled using the python <strong>job</strong> script.</em></p>
<h2 id="parameter-modification">Parameter modification</h2>
<p>Yelmo depends on a namelist file with default parameter values located in the <code>src</code> directory (<code>src/yelmo.nml</code>). This file should remain unchanged during production runs, it is only used to initially load all parameter values.</p>
<p>Next, in the main directory, there should be one namelist file per modeled domain (e.g., <code>Greenland.nml</code>), with each group of parameters corresponding to each model component. The name of this namelist file corresponds to the name of the domain given in the code when the domain was initialized. As the program runs, it first loads parameters from the default namelist file, then it checks if any parameters should be overwritten from the domain-specific namelist file.</p>
<p>This two step procedure is convenient in that usually the default values do not change and can be stored for reference in the model component namelist file. Meanwhile in the domain-specific namelist file, only the parameters of interest that need to be modified for a given run need to be specified.</p>
<h1 id="libraries">Libraries</h1>
<p>Yelmo relies on some external libraries (some of which have been built specifically for use with it), however the Yelmo repository is mostly self-contained. If the libraries are portable, like fortran modules, then they are stored in the <code>libs/</code> subdirectory. The only external dependency is on the NetCDF libraries, which must be preinstalled on the system.</p>
<p>Below is a list of the libraries used in Yelmo:</p>
<p><strong>nml</strong> is a custom library for reading namelist parameters into a Fortran program. It has the same functionality as native nml reading, however it does not require the definition of a common block.</p>
<p><strong>coordinates</strong> handles the definition of grids and points on user-specified coordinate systems. It has the ability to map between different coordinate systems, interpolation and oblique stereographic projection.</p>
<p><strong>subset</strong> depends on the coordinates module and allows subsets of points to be generated from pre-defined grids. The subset of points can be of higher resolution than the original grid, and if so, mapping to and from the original grid is handled internally.</p>
<p><strong>insol</strong> provides functions to calculate the daily insolation at any latitude for any time up to 5 Ma BP or 1 Ma AP (after present).</p>
<p><strong>solvers</strong> provides some basic differential equation solvers.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '.';</script>
        <script src="./js/base.js"></script>
        <script src="./search/require.js"></script>
        <script src="./search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>

<!--
MkDocs version : 0.17.2
Build Date UTC : 2017-11-26 22:15:11
-->
